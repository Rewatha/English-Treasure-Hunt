<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Picture Puzzle Challenge - English Treasure Hunt</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
        }
        .pulse-animation {
            animation: p30ulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        const { useState, useEffect } = React;

        // Picture puzzles database (30 puzzles)
        const PICTURE_PUZZLES = [
            { id: 1, emojis: "ðŸ + ðŸ°", answer: "beehive", hint: "Where bees live" },
            { id: 2, emojis: "ðŸ‘ + ðŸ§Š", answer: "ice", hint: "Frozen water, sounds like 'eye'" },
            { id: 3, emojis: "â˜€ + ðŸ’¡", answer: "daylight", hint: "Light during the day" },
            { id: 4, emojis: "ðŸˆ + ðŸŸ", answer: "catfish", hint: "A type of fish" },
            { id: 5, emojis: "ðŸ’¡ + ðŸ”“", answer: "unlock", hint: "Open a lock" },
            { id: 6, emojis: "ðŸ“– + â¤", answer: "booklover", hint: "Someone who loves reading" },
            { id: 7, emojis: "ðŸŒ§ + ðŸŒˆ", answer: "rainbow", hint: "Appears after rain" },
            { id: 8, emojis: "ðŸ˜ + ðŸ“š", answer: "intelligent", hint: "Elephants are smart" },
            { id: 9, emojis: "ðŸ• + ðŸž", answer: "breakfast", hint: "Morning meal" },
            { id: 10, emojis: "ðŸ  + ðŸ–¼", answer: "wallpaper", hint: "Decoration on walls" },
            { id: 11, emojis: "ðŸ”¥ + â„", answer: "fireandice", hint: "Two opposites" },
            { id: 12, emojis: "ðŸ‘‚ + ðŸ“š", answer: "listen", hint: "Use your ears" },
            { id: 13, emojis: "ðŸŽ + ðŸ’»", answer: "apple", hint: "A fruit and a brand" },
            { id: 14, emojis: "ðŸ•µ + ðŸ”", answer: "detective", hint: "Investigates mysteries" },
            { id: 15, emojis: "ðŸ§  + ðŸ’­", answer: "think", hint: "Use your brain" },
            { id: 16, emojis: "ðŸ¦ + ðŸ“¨", answer: "twitter", hint: "Social media platform" },
            { id: 17, emojis: "ðŸ’¬ + ðŸŒ", answer: "communication", hint: "Talking to others" },
            { id: 18, emojis: "ðŸ‘£ + ðŸ“œ", answer: "footnote", hint: "Note at bottom of page" },
            { id: 19, emojis: "ðŸŽ§ + ðŸŽµ", answer: "music", hint: "What you hear through headphones" },
            { id: 20, emojis: "ðŸ¢ + â±", answer: "slow", hint: "Not fast" },
            { id: 21, emojis: "ðŸŽ“ + ðŸ‘", answer: "graduate", hint: "Finish school" },
            { id: 22, emojis: "ðŸ¦· + ðŸª¥", answer: "toothbrush", hint: "Clean your teeth" },
            { id: 23, emojis: "ðŸ« + ðŸ°", answer: "chocolatecake", hint: "Sweet dessert" },
            { id: 24, emojis: "ðŸŒ + âœˆ", answer: "travel", hint: "Go to different places" },
            { id: 25, emojis: "ðŸ•’ + ðŸƒ", answer: "hurry", hint: "Move quickly, time is running" },
            { id: 26, emojis: "ðŸ”‘ + ðŸ§ ", answer: "smartkey", hint: "Clever idea" },
            { id: 27, emojis: "ðŸ“± + ðŸ’¬", answer: "message", hint: "Text on phone" },
            { id: 28, emojis: "ðŸ¦‹ + ðŸŒ¸", answer: "beauty", hint: "Something beautiful" },
            { id: 29, emojis: "ðŸŽ­ + ðŸ‘", answer: "actor", hint: "Performs in plays" },
            { id: 30, emojis: "âœ + ðŸ“–", answer: "writing", hint: "Creating text" }
        ];

        // Icons
        const Clock = () => (
            React.createElement('svg', { 
                xmlns: "http://www.w3.org/2000/svg", 
                width: "20", 
                height: "20", 
                viewBox: "0 0 24 24", 
                fill: "none", 
                stroke: "currentColor", 
                strokeWidth: "2", 
                strokeLinecap: "round", 
                strokeLinejoin: "round",
                style: { display: 'inline' }
            },
                React.createElement('circle', { cx: "12", cy: "12", r: "10" }),
                React.createElement('polyline', { points: "12 6 12 12 16 14" })
            )
        );

        const Image = () => (
            React.createElement('svg', { 
                xmlns: "http://www.w3.org/2000/svg", 
                width: "48", 
                height: "48", 
                viewBox: "0 0 24 24", 
                fill: "none", 
                stroke: "currentColor", 
                strokeWidth: "2", 
                strokeLinecap: "round", 
                strokeLinejoin: "round"
            },
                React.createElement('rect', { x: "3", y: "3", width: "18", height: "18", rx: "2", ry: "2" }),
                React.createElement('circle', { cx: "8.5", cy: "8.5", r: "1.5" }),
                React.createElement('polyline', { points: "21 15 16 10 5 21" })
            )
        );

        function PicturePuzzleChallenge() {
            const [stage, setStage] = useState('select'); // 'select', 'playing', 'correct', 'wrong'
            const [selectedNumber, setSelectedNumber] = useState('');
            const [currentPuzzle, setCurrentPuzzle] = useState(null);
            const [answer, setAnswer] = useState('');
            const [timeLeft, setTimeLeft] = useState(60);
            const [playerName, setPlayerName] = useState('');
            const [showHint, setShowHint] = useState(false);

            // Load player info
            useEffect(() => {
                try {
                    const currentPlayer = localStorage.getItem('currentPlayer');
                    if (currentPlayer) {
                        const player = JSON.parse(currentPlayer);
                        setPlayerName(player.name);
                    } else {
                        // No player logged in, redirect to login
                        window.location.href = 'index.html';
                    }
                } catch (e) {
                    window.location.href = 'index.html';
                }
            }, []);

            // Timer countdown
            useEffect(() => {
                if (stage === 'playing' && timeLeft > 0) {
                    const timer = setTimeout(() => {
                        setTimeLeft(timeLeft - 1);
                    }, 1000);
                    return () => clearTimeout(timer);
                } else if (stage === 'playing' && timeLeft === 0) {
                    setStage('wrong');
                }
            }, [stage, timeLeft]);

            const handleNumberSelect = () => {
                const num = parseInt(selectedNumber);
                if (num >= 1 && num <= 30) {
                    // Pick a RANDOM puzzle (not based on the number)
                    const randomIndex = Math.floor(Math.random() * PICTURE_PUZZLES.length);
                    const puzzle = PICTURE_PUZZLES[randomIndex];
                    setCurrentPuzzle(puzzle);
                    setStage('playing');
                    setTimeLeft(30);
                    setShowHint(false);
                }
            };

            const checkAnswer = () => {
                if (!answer.trim()) return;

                const userAnswer = answer.toLowerCase().trim().replace(/\s+/g, '');
                const correctAnswer = currentPuzzle.answer.toLowerCase().replace(/\s+/g, '');

                if (userAnswer === correctAnswer) {
                    setStage('correct');
                    // Save progress
                    localStorage.setItem('picturePuzzleCompleted', 'true');
                } else {
                    setStage('wrong');
                }
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter') {
                    if (stage === 'select') {
                        handleNumberSelect();
                    } else if (stage === 'playing') {
                        checkAnswer();
                    }
                }
            };

            const handleShowHint = () => {
                setShowHint(true);
            };

            const goToNextChallenge = () => {
                window.location.href = 'riddle-challenge.html';
            };

            const tryAgain = () => {
                window.location.href = 'index.html';
            };

            // SELECT NUMBER STAGE
            if (stage === 'select') {
                return React.createElement('div', { 
                    className: "min-h-screen bg-gradient-to-br from-orange-400 via-pink-500 to-purple-600 flex items-center justify-center p-4" 
                },
                    React.createElement('div', { className: "bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center" },
                        React.createElement('div', { className: "mb-6 flex justify-center" },
                            React.createElement(Image)
                        ),
                        React.createElement('h1', { className: "text-3xl font-bold text-gray-800 mb-2" },
                            'ðŸ–¼ Picture Puzzle Challenge'
                        ),
                        React.createElement('p', { className: "text-gray-600 mb-2" },
                            'Welcome, ' + playerName + '!'
                        ),
                        React.createElement('p', { className: "text-sm text-gray-500 mb-6" },
                            'Entry Challenge - Stage 1 of 2'
                        ),
                        React.createElement('div', { className: "bg-blue-50 rounded-xl p-6 mb-6" },
                            React.createElement('h3', { className: "font-bold text-gray-800 mb-3" },
                                'ðŸ“‹ Instructions:'
                            ),
                            React.createElement('ul', { className: "text-sm text-gray-700 text-left space-y-2" },
                                React.createElement('li', null, '1ï¸âƒ£ Pick a number from 1 to 30'),
                                React.createElement('li', null, '2ï¸âƒ£ You\'ll see emoji picture puzzle'),
                                React.createElement('li', null, '3ï¸âƒ£ Guess the English word'),
                                React.createElement('li', null, 'â±ï¸ You have 60 seconds'),
                                React.createElement('li', null, 'âœ… Correct â†’ Move to Riddle Challenge'),
                                React.createElement('li', null, 'âŒ Wrong â†’ Try again later')
                            )
                        ),
                        React.createElement('div', { className: "mb-6" },
                            React.createElement('label', { className: "block text-sm font-semibold text-gray-700 mb-2" },
                                'Pick a number (1-30):'
                            ),
                            React.createElement('input', {
                                type: "number",
                                min: "1",
                                max: "30",
                                value: selectedNumber,
                                onChange: (e) => setSelectedNumber(e.target.value),
                                onKeyPress: handleKeyPress,
                                placeholder: "Enter number",
                                className: "w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-orange-500 focus:outline-none transition-colors text-center text-2xl font-bold"
                            })
                        ),
                        React.createElement('button', {
                            onClick: handleNumberSelect,
                            disabled: !selectedNumber || selectedNumber < 1 || selectedNumber > 30,
                            className: "w-full bg-gradient-to-r from-orange-500 to-pink-500 text-white font-bold py-4 px-6 rounded-xl hover:from-orange-600 hover:to-pink-600 transform hover:scale-105 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"
                        }, 'ðŸŽ¯ Show Me the Puzzle!')
                    )
                );
            }

            // PLAYING STAGE
            if (stage === 'playing') {
                return React.createElement('div', { 
                    className: "min-h-screen bg-gradient-to-br from-orange-400 via-pink-500 to-purple-600 flex items-center justify-center p-4" 
                },
                    React.createElement('div', { className: "bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full" },
                        React.createElement('div', { className: "text-center mb-6" },
                            React.createElement('div', { 
                                className: "inline-block bg-gradient-to-r from-red-500 to-orange-500 text-white px-6 py-3 rounded-full font-bold text-xl mb-4 " + (timeLeft <= 10 ? 'pulse-animation' : '')
                            },
                                React.createElement(Clock),
                                ' ' + timeLeft + 's'
                            ),
                            React.createElement('h2', { className: "text-2xl font-bold text-gray-800 mb-2" },
                                'Puzzle #' + currentPuzzle.id
                            ),
                            React.createElement('p', { className: "text-sm text-gray-600" },
                                'What word do these emojis represent?'
                            )
                        ),
                        React.createElement('div', { className: "bg-gradient-to-br from-yellow-100 to-orange-100 rounded-2xl p-8 mb-6 text-center" },
                            React.createElement('div', { className: "text-6xl mb-4" },
                                currentPuzzle.emojis
                            ),
                            showHint && React.createElement('div', { className: "bg-white rounded-lg p-3 mt-4" },
                                React.createElement('p', { className: "text-sm text-gray-600 font-semibold" },
                                    'ðŸ’¡ Hint: ' + currentPuzzle.hint
                                )
                            )
                        ),
                        React.createElement('div', { className: "mb-6" },
                            React.createElement('label', { className: "block text-sm font-semibold text-gray-700 mb-2" },
                                'Your Answer:'
                            ),
                            React.createElement('input', {
                                type: "text",
                                value: answer,
                                onChange: (e) => setAnswer(e.target.value),
                                onKeyPress: handleKeyPress,
                                placeholder: "Type the word here",
                                className: "w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-orange-500 focus:outline-none transition-colors text-center text-xl",
                                autoFocus: true
                            })
                        ),
                        timeLeft <= 35 && React.createElement('div', { className: "mb-4" },
                            React.createElement('button', {
                                onClick: handleShowHint,
                                disabled: showHint,
                                className: "w-full bg-yellow-500 text-white font-bold py-3 px-4 rounded-xl hover:bg-yellow-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
                            }, showHint ? 'ðŸ’¡ Hint Shown' : 'ðŸ’¡ Show Hint')
                        ),
                        React.createElement('button', {
                            onClick: checkAnswer,
                            disabled: !answer.trim(),
                            className: "w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-4 px-6 rounded-xl hover:from-green-600 hover:to-emerald-700 transform hover:scale-105 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"
                        }, 'âœ… Submit Answer')
                    )
                );
            }

            // CORRECT ANSWER STAGE
            if (stage === 'correct') {
                return React.createElement('div', { 
                    className: "min-h-screen bg-gradient-to-br from-green-400 via-emerald-500 to-teal-600 flex items-center justify-center p-4" 
                },
                    React.createElement('div', { className: "bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center" },
                        React.createElement('div', { className: "mb-6" },
                            React.createElement('div', { className: "text-8xl mb-4 animate-bounce" }, 'ðŸŽ‰')
                        ),
                        React.createElement('h2', { className: "text-4xl font-bold text-green-600 mb-4" },
                            'Correct!'
                        ),
                        React.createElement('p', { className: "text-xl text-gray-700 mb-6" },
                            'The answer is: ',
                            React.createElement('strong', null, currentPuzzle.answer)
                        ),
                        React.createElement('div', { className: "bg-green-50 rounded-xl p-6 mb-6" },
                            React.createElement('p', { className: "text-gray-700 mb-4" },
                                'âœ… You passed Stage 1!'
                            ),
                            React.createElement('p', { className: "text-sm text-gray-600" },
                                'Next: Riddle Challenge (Stage 2)'
                            )
                        ),
                        React.createElement('button', {
                            onClick: goToNextChallenge,
                            className: "w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-4 px-6 rounded-xl hover:from-green-600 hover:to-emerald-700 transform hover:scale-105 transition-all shadow-lg text-lg"
                        }, 'âž¡ï¸ Continue to Riddle Challenge')
                    )
                );
            }

            // WRONG ANSWER STAGE
            if (stage === 'wrong') {
                return React.createElement('div', { 
                    className: "min-h-screen bg-gradient-to-br from-red-400 via-pink-500 to-purple-600 flex items-center justify-center p-4" 
                },
                    React.createElement('div', { className: "bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center" },
                        React.createElement('div', { className: "mb-6" },
                            React.createElement('div', { className: "text-8xl mb-4" }, 'ðŸ˜”')
                        ),
                        React.createElement('h2', { className: "text-4xl font-bold text-red-600 mb-4" },
                            timeLeft === 0 ? 'Time\'s Up!' : 'Not Quite!'
                        ),
                        React.createElement('p', { className: "text-xl text-gray-700 mb-2" },
                            'The correct answer was:'
                        ),
                        React.createElement('p', { className: "text-3xl font-bold text-purple-600 mb-6" },
                            currentPuzzle.answer
                        ),
                        React.createElement('div', { className: "bg-yellow-50 border-2 border-yellow-300 rounded-xl p-6 mb-6" },
                            React.createElement('p', { className: "text-gray-700 font-semibold mb-2" },
                                'âŒ Challenge Failed'
                            ),
                            React.createElement('p', { className: "text-sm text-gray-600" },
                                'Don\'t give up! Come back and try again with a different puzzle number.'
                            )
                        ),
                        React.createElement('button', {
                            onClick: tryAgain,
                            className: "w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold py-4 px-6 rounded-xl hover:from-purple-600 hover:to-pink-600 transform hover:scale-105 transition-all shadow-lg text-lg"
                        }, 'ðŸ”„ Try Next Time')
                    )
                );
            }
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(PicturePuzzleChallenge));
    </script>
</body>
</html>